# name: test/sql/parser_tools/scalar_functions/parse_statements.test
# description: test parse_statements scalar function
# group: [parse_statements]

# Before we load the extension, this will fail
statement error
SELECT parse_statements('SELECT 42; SELECT 43;');
----
Catalog Error: Scalar Function with name parse_statements does not exist!

# Require statement will ensure this test is run with this extension loaded
require parser_tools

# Single statement
query I
SELECT parse_statements('SELECT 42;');
----
[SELECT 42]

# Multiple statements
query I
SELECT parse_statements('SELECT 42; SELECT 43;');
----
[SELECT 42, SELECT 43]

# Three statements
query I
SELECT parse_statements('SELECT 1; SELECT 2; SELECT 3;');
----
[SELECT 1, SELECT 2, SELECT 3]

# Multiple statements with different types
query I
SELECT parse_statements('SELECT 1; INSERT INTO test VALUES (2); SELECT 3;');
----
[SELECT 1, 'INSERT INTO test (VALUES (2))', SELECT 3]

# Complex multi-statement query
query I
SELECT parse_statements($$
    WITH cte AS (SELECT 1 as a) SELECT * FROM cte;
    SELECT upper('hello');
    SELECT count(*) FROM users WHERE id > 10;
$$);
----
['WITH cte AS (SELECT 1 AS a)SELECT * FROM cte', 'SELECT upper(\'hello\')', 'SELECT count_star() FROM users WHERE (id > 10)']

# Empty input
query I
SELECT parse_statements('');
----
[]

# Whitespace only
query I
SELECT parse_statements('   ');
----
[]

# Invalid SQL should return empty list
query I
SELECT parse_statements('INVALID SQL SYNTAX HERE');
----
[]